@use "../variables" as v;

/* BEM formatting with scss niceties
  box__element --modifier
  seperate the modifiers because they should be unique to a box/box__element. This makes the css/scss MUCH cleaner
  -Rascal-GL

  Reference:
  https://codepen.io/glorenz90/pen/wBBVqxG
*/

.sliced-border {
  width: fit-content;
  height: fit-content;
  display: flex;
  position: relative;
  padding: 4px 2px;
  background: var(--theme-bg-color);

  &:has(> .sliced-border__label) {
    padding-top: v.$gap-sliced-border + 3px;
  }

  &:has(> .sliced-border__label.sliced-border) {
    padding-top: v.$gap-sliced-border + 16px;
  }

  &::before {
    pointer-events: none;
    position: absolute;
    z-index: 0;
    content: "";
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    border-style: solid;
    border-width: 16px;
    border-color: var(--theme-border-color);

    @supports (mask-border: none) {
      mask-border: var(--theme-border-image) 16 round;
    }
    @supports (-webkit-mask-box-image: none) {
      -webkit-mask-box-image: var(--theme-border-image) 16 round;
    }

    @supports not (-webkit-mask-box-image: none) {
      filter: var(--theme-border-filter);
      border-image: var(--theme-border-image);
      border-image-slice: 16;
    }
  }

  &.--col {
    flex-direction: column;
  }

  &.--thin::before {
    @supports (mask-border: none) {
      mask-border: var(--theme-border-image) 16 round;
    }
    @supports (-webkit-mask-box-image: none) {
      -webkit-mask-box-image: var(--theme-border-image) 16 round;
    }

    @supports not (-webkit-mask-box-image: none) {
      border-image: var(--theme-border-image);
      border-image-slice: 16;
    }
  }

  &.--filled {
    color: var(--theme-bg-color) !important; // Could be included, but this is appropriate here
    font-weight: bold;

    &::before {
      @supports (mask-border: none) {
        background: var(--sheet-border-color);
        mask-border: var(--theme-filled-border-image) 16 round;
      }
      @supports (-webkit-mask-box-image: none) {
        background: var(--sheet-border-color);
        -webkit-mask-box-image: var(--theme-filled-border-image) 16 round;
      }

      @supports not (-webkit-mask-box-image: none) {
        border-image: var(--theme-filled-border-image);
        border-image-slice: 16 fill;
      }
    }
  }

  &.--thick::before {
    @supports (mask-border: none) {
      mask-border: var(--theme-thick-border-image) 16 round;
    }
    @supports (-webkit-mask-box-image: none) {
      -webkit-mask-box-image: var(--theme-thick-border-image) 16 round;
    }

    @supports not (-webkit-mask-box-image: none) {
      border-image: var(--theme-thick-border-image);
      border-image-slice: 16;
    }
  }

  &.--tab {
    &::before {
      @supports (mask-border: none) {
        mask-border: var(--theme-tab-image) 16 round;
      }
      @supports (-webkit-mask-box-image: none) {
        -webkit-mask-box-image: var(--theme-tab-image) 16 round;
      }

      @supports not (-webkit-mask-box-image: none) {
        border-image: var(--theme-tab-image);
        border-image-slice: 16;
      }
    }
    
    &.--filled::before {
      @supports (mask-border: none) {
        background: var(--sheet-border-color);
        mask-border: var(--theme-filled-tab-image) 16 round;
      }
      @supports (-webkit-mask-box-image: none) {
        background: var(--sheet-border-color);
        -webkit-mask-box-image: var(--theme-filled-tab-image) 16 round;
      }

      @supports not (-webkit-mask-box-image: none) {
        border-image: var(--theme-filled-tab-image);
        border-image-slice: 16 fill;
      }
    }
  }

  .sliced-border__label {
    z-index: 2;
    display: flex;
    gap: v.$gap-md;
    justify-content: center;
    align-items: center;
    color: var(--theme-border-color);
    width: max-content;
    position: absolute;
    top: 0;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  label.sliced-border__label {
    padding: 0 8px;
    line-height: 0.75rem;
    background: var(--theme-bg-color);
  }

  .sliced-border__input-row {
    display: flex;
    width: 100%;
    gap: v.$gap-md;
    *:nth-child(1) {
      flex-grow: 1;
    }
  }
}
