<style>
  .e20-window:has(.{{system.windowId}}) {
    --theme-border-color: {{system.color}};
  }
</style>
<form class="{{cssClass}} {{actor.type}} {{system.windowId}}" autocomplete="off">
  {{!-- Actor Sheet Header --}}
  {{> "systems/essence20/templates/actor/parts/headers/npc.hbs"}}

  {{!-- Tabs --}}
  <nav class="sheet-tabs" data-group="primary">
    {{#if system.isNPC}}
      <a class="sliced-border --tab" style="border-color: {{system.color}};" data-tab="npc"><span>{{ localize "E20.TabNPC" }}</span></a>
    {{/if}}
    {{#if system.isContact}}
      <a class="sliced-border --tab" style="border-color: {{system.color}};" data-tab="contact"><span>{{ localize "E20.TabContact" }}</span></a>
    {{/if}}
    {{#if system.canTransform}}
      <a class="sliced-border --tab" style="border-color: {{system.color}};" data-tab="altmode"><span>{{ localize "E20.TabAltMode" }}</span></a>
    {{/if}}
    <a class="sliced-border --tab" style="border-color: {{system.color}};" data-tab="notes"><span></span>{{ localize "E20.TabNotes" }}</span></a>
  </nav>

  {{!-- Actor Sheet Body --}}
  <section class="sheet-body flexcol sliced-border --thick" style="border-color: {{system.color}};">
    {{!-- NPC Tab --}}
    <div class="tab main flexcol" data-group="primary" data-tab="npc">
      <div class="npc-row">
        <div class="npc-defenses">
          {{!-- NPC Defenses --}}
          {{> "systems/essence20/templates/actor/parts/misc/npc-defenses.hbs"}}
        </div>
        <div class="npc-health">
          {{!-- Health --}}
          {{> "systems/essence20/templates/actor/parts/misc/health.hbs"}}
        </div>
        <div class="npc-health">
          {{!-- Stun --}}
          {{> "systems/essence20/templates/actor/parts/misc/stun.hbs"}}
        </div>
      </div>
      <div class="npc-row">
        {{!-- NPC Can Transform --}}
        {{> "systems/essence20/templates/actor/parts/misc/morph-transform.hbs"}}
        <div class="npc-essence-scores">
          {{!-- NPC Essence Scores --}}
          {{> "systems/essence20/templates/actor/parts/misc/npc-essence-scores.hbs"}}
        </div>
        <div class="npc-movement">
          {{!-- Movement --}}
          {{> "systems/essence20/templates/actor/parts/misc/movement.hbs"}}
        </div>
      </div>

      <div class="npc-row">
        {{!-- Skills --}}
        <div class="npc-skills">
          {{> "systems/essence20/templates/actor/parts/misc/accordion-skills.hbs"}}
        </div>

        {{!-- Items --}}
        <div class="npc-items">
          {{#if actor.system.canMorph}}
            {{> "systems/essence20/templates/actor/parts/misc/power-points.hbs"}}
          {{else if actor.system.powers.sorcerous.levelTaken}}
            {{> "systems/essence20/templates/actor/parts/misc/power-points.hbs"}}
          {{/if}}
          {{> "systems/essence20/templates/actor/parts/items/weapon/container.hbs"}}
          {{> "systems/essence20/templates/actor/parts/misc/immunities-resistances.hbs"}}
          {{> "systems/essence20/templates/actor/parts/items/hangUp/container.hbs"}}
          {{> "systems/essence20/templates/actor/parts/items/power/container.hbs"}}
          {{> "systems/essence20/templates/actor/parts/items/perk/container.hbs" perkType="general" perks=@root.perks.all title="E20.ItemTypePerkPlural" alwaysShow="true"}}
          {{> "systems/essence20/templates/actor/parts/items/gear/container.hbs"}}
          {{> "systems/essence20/templates/actor/parts/items/spell/container.hbs"}}
        </div>
      </div>
    </div>

    {{!-- Contact Tab --}}
    <div class="tab contact flexcol" data-group="primary" data-tab="contact">
      {{> "systems/essence20/templates/actor/parts/misc/contact.hbs"}}
    </div>
    {{!-- Alt Mode Tab --}}
    <div class="tab altmode" data-group="primary" data-tab="altmode">
      {{> "systems/essence20/templates/actor/parts/misc/energon.hbs"}}
      {{> "systems/essence20/templates/actor/parts/items/altMode/container.hbs"}}
    </div>

    {{!-- Notes Tab --}}
    <div class="tab notes" data-group="primary" data-tab="notes">
      {{> "systems/essence20/templates/actor/parts/misc/notes.hbs"}}
    </div>
  </section>
</form>
